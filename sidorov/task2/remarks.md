Очень похоже на правду. Было бы здорово еще с коэффициентами поиграться, поскольку иногда значение энергии на грани, и в структуру не попадает часть петли/листа. Но, вообще, все хорошо. Задача зачтена.
